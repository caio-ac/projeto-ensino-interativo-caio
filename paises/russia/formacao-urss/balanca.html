<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <title>Stalin vs Trotsky: Luta pelo Poder</title>
    <style>
        body {
            background-color: #2b2b2b;
            color: white;
            text-align: center;
            
        }
        .battle-container {
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            padding: 50px;
        }
        .character {
            width: 200px;
            position: relative;
        }
        .character img {
            width: 200px;                         
            transition: transform 1s;
        }
        .character img.shake {
            transform: translateX(10px);
            animation: shake 0.5s infinite;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(5px); }
            50% { transform: translateX(0); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        .container-power{
            position: sticky; 
            top: 0;
        }
        /* Certifique-se de que a opacidade seja alterada com uma transição suave */
        .event-image {
            width: auto;
            height: 300px;
            opacity: 1;
            transition: opacity 1s ease-in-out;
        }

        /* Classe para o fade-out */
        .fade {
            opacity: 0;
        }

        /* Classe para o fade-in */
        .fade-in {
            opacity: 1;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .power-bar {
            width: 100%;
            background-color: #333;
            border-radius: 20px;
            overflow: hidden;
            height: 30px;
            margin-top: 10px;
            border: 2px solid #fff;
        }
        .power {
            height: 100%;
            background-color: red;
            width: 50%;
            transition: width 1s ease-in-out;
        }
        .power.stalin {
            background-color: blue;
        }
        .event-description {
            font-size: 1.2em;
            opacity: 1;
            transition: opacity 1s ease-in-out;
            max-width: 600px;
            margin: 20px auto;
            border: 2px solid #444545;
            padding: 10px;
            border-radius: 10px;
        }
        .event-details {
            display: block;
            font-size: 1em;
            color: #f0f0f0;
            background-color: #444;
            padding: 10px;
            border-radius: 10px;
            margin-top: 10px;
            border: 1px solid #444545;
        }
        .hidden {
            display: none;
        }
        .previous-event .event-details {
            display: none;
        }
        .previous-event:hover .event-details {
            display: block;
        }
        .legend {
            margin-top: 10px;
            font-size: 1em;
            color: #f0f0f0;
        }

        .show-titles-only .event-details {
            display: none;
        }

        #event4.show-titles-only:hover .event-details {
            display: block;
        }

        .hide-event {
            visibility: hidden;
        }

        .disable-hover:hover .event-details {
            display: none !important;
        }

        .color-text{
            color: white;
        }

    </style>
      
</head>
<body>

    <div class="container">
    <nav class="navbar navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand color-text" href="#">
                <img src="assets/images/communist.png" alt="Logo" width="30" height="30" class="d-inline-block align-text-top">
                Balança de Poder
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link color-text" href="pagina_1924.html" id="inicio-btn">Voltar</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link color-text" href="#" id="reiniciar-btn">Reiniciar</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-power">
    <div class="battle-container">
        <div class="character">
            <img id="trotsky-img" src="https://upload.wikimedia.org/wikipedia/commons/1/1f/%D0%9B%D0%B5%D0%B2_%D0%94%D0%B0%D0%B2%D0%B8%D0%B4%D0%BE%D0%B2%D0%B8%D1%87_%D0%A2%D1%80%D0%BE%D1%86%D0%BA%D0%B8%D0%B9.jpg" alt="Trotsky">
            <div class="power-bar">
                <div id="trotsky-power" class="power" style="width: 60%"></div>
            </div>
            <p>Poder de Trotsky</p>
        </div>

        <div id="container-image" class="container-image">
            <img id="event-image" class="event-image" src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Flag_of_the_Soviet_Union.svg" alt="Imagem do Evento">
            <p id="legend" class="legend">Balança de Poder da URSS</p>
        </div>

        <div class="character">
            <img id="stalin-img" src="https://upload.wikimedia.org/wikipedia/commons/3/3c/StalinCropped1943%28b%29.jpg" alt="Stalin">
            <div class="power-bar">
                <div id="stalin-power" class="power stalin" style="width: 40%"></div>
            </div>
            <p>Poder de Stalin</p>
        </div>
    </div>
    </div>

    <div class="event-description hidden" id="event1">
        <p>1923: Stalin começa a consolidar poder formando alianças dentro do Partido Comunista.</p>
        <div class="event-details">
            <p>Stalin usou sua posição como Secretário Geral para colocar aliados em posições-chave, construindo uma base de apoio.</p>
        </div>
    </div>

    <div class="event-description hidden" id="event2">
        <p>1925: Trotsky é marginalizado enquanto Stalin ganha mais apoio de figuras-chave do partido.</p>
        <div class="event-details">
            <p>Trotsky, outrora visto como herdeiro de Lenin, foi cada vez mais isolado enquanto Stalin construía alianças com Zinoviev e Kamenev.</p>
        </div>
    </div>

    <div class="event-description hidden" id="event3">
        <p>1927: Trotsky é removido do Partido Comunista, enfraquecendo ainda mais sua influência.</p>
        <div class="event-details">
            <p>À medida que o poder de Stalin crescia, Trotsky foi expulso do partido, marcando uma vitória decisiva para Stalin.</p>
        </div>
    </div>

    <div class="event-description hidden" id="event4">
        <p>1929: Trotsky é exilado da União Soviética, deixando Stalin como líder incontestado.</p>
        <div class="event-details">
            <p>Em 1929, Trotsky foi forçado ao exílio, marcando o fim de sua carreira política na União Soviética.</p>
        </div>
    </div>  
    </div>

    <script>
        const trotskyPower = document.getElementById('trotsky-power');
        const stalinPower = document.getElementById('stalin-power');
        const trotskyImg = document.getElementById('trotsky-img');
        const stalinImg = document.getElementById('stalin-img');
        const eventImage = document.getElementById('event-image');
        const legend = document.getElementById('legend');
        const containerImage = document.getElementById('container-image');

        const event1 = document.getElementById('event1');
        const event2 = document.getElementById('event2');
        const event3 = document.getElementById('event3');
        const event4 = document.getElementById('event4');
        const allEvents = [event1, event2, event3, event4];

        // Variáveis para as imagens dos eventos
        const event1Image = 'https://upload.wikimedia.org/wikipedia/commons/e/e3/Lenin_and_stalin_crop.jpg';
        const event2Image = 'https://upload.wikimedia.org/wikipedia/commons/6/6e/Stalin_Rykov_Kamenev_Zinoviev_1925.jpg';
        const event3Image = 'https://upload.wikimedia.org/wikipedia/commons/4/4e/Leon_Trotsky_1928.jpg';
        const event4Image = 'https://upload.wikimedia.org/wikipedia/commons/9/94/Trotskynina1915.jpg';

        function updateEventVisibility(currentIndex) {
            for (let i = 0; i < allEvents.length; i++) {
                if (i <= currentIndex) {
                    allEvents[i].classList.remove('hidden');
                    if (i < currentIndex) {
                        allEvents[i].classList.add('previous-event');
                    } else {
                        allEvents[i].classList.remove('previous-event');
                    }
                } else {
                    allEvents[i].classList.add('hidden');
                }
            }

            const legends = [
                '1923: Stalin começa a consolidar poder',
                '1925: Trotsky é marginalizado',
                '1927: Trotsky é expulso do Partido Comunista',
                '1929: Trotsky é exilado da União Soviética'
            ];
            legend.textContent = legends[currentIndex];

            // Faz o scroll para o evento atual
            allEvents[currentIndex].scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function fadeOutImage() {
            eventImage.classList.add('fade');
            eventImage.classList.remove('fade-in'); 
        }

        function fadeInImage() {
            eventImage.classList.remove('fade'); 
            setTimeout(() => { 
                eventImage.classList.add('fade-in');
            }, 50);
        }


        function showEvents(){
        setTimeout(() => {
            fadeOutImage();
            setTimeout(() => {
                updateEventVisibility(0); 
                trotskyPower.style.width = '55%';
                stalinPower.style.width = '45%';
                trotskyImg.classList.add('shake');
                eventImage.src = event1Image; 
                fadeInImage();
            }, 1000);
        }, 1000);

        setTimeout(() => {
            fadeOutImage();
            setTimeout(() => {
                updateEventVisibility(1); 
                trotskyPower.style.width = '40%';
                stalinPower.style.width = '60%';
                trotskyImg.classList.remove('shake');
                stalinImg.classList.add('shake');
                eventImage.src = event2Image; 
                fadeInImage();
            }, 1000);
        }, 5000);

        setTimeout(() => {
            fadeOutImage();
            setTimeout(() => {
                updateEventVisibility(2); 
                trotskyPower.style.width = '20%';
                stalinPower.style.width = '80%';
                eventImage.src = event3Image; 
                fadeInImage();
            }, 1000);
        }, 9000);

        setTimeout(() => {
            fadeOutImage();
            setTimeout(() => {
                updateEventVisibility(3); 
                trotskyPower.style.width = '0%';
                stalinPower.style.width = '100%';
                stalinImg.classList.add('shake');
                eventImage.src = event4Image; 
                fadeInImage();
            }, 1000);
        }, 13000);

        setTimeout(() => {
            allEvents.forEach((event) => {
                event.classList.add('show-titles-only');
            });
            trotskyImg.classList.remove('shake');
            stalinImg.classList.remove('shake');
        }, 17000); 
    }

        // Função para alterar a imagem e legenda durante o hover
        function setImageAndLegend(eventIndex) {
            const eventImages = [event1Image, event2Image, event3Image, event4Image]; 
            const eventLegends = [
                '1923: Stalin começa a consolidar poder',
                '1925: Trotsky é marginalizado',
                '1927: Trotsky é expulso do Partido Comunista',
                '1929: Trotsky é exilado da União Soviética'
            ];

            eventImage.src = eventImages[eventIndex];
            legend.textContent = eventLegends[eventIndex];
        }

        allEvents.forEach((event, index) => {
            event.addEventListener('mouseover', () => {
                setImageAndLegend(index);
            });
            event.addEventListener('mouseout', () => {
                setImageAndLegend(index); 
            });
        });

        function checkContainerOverlap() {
            const containerRect = containerImage.getBoundingClientRect();
            
            allEvents.forEach(event => {
                const eventRect = event.getBoundingClientRect();
                const isOverlapping = !(containerRect.bottom < eventRect.top || 
                                        containerRect.top > eventRect.bottom || 
                                        containerRect.right < eventRect.left || 
                                        containerRect.left > eventRect.right);

                if (isOverlapping) {
                    event.classList.add('hide-event');
                } else {
                    event.classList.remove('hide-event');
                }
            });
        }

        window.addEventListener('scroll', checkContainerOverlap);
        window.addEventListener('resize', checkContainerOverlap);
        showEvents();

        document.getElementById('reiniciar-btn').addEventListener('click', () => {
            trotskyPower.style.width = '60%';
            stalinPower.style.width = '40%';
            stalinImg.classList.remove('shake');
            trotskyImg.classList.remove('shake');
            eventImage.src = 'https://upload.wikimedia.org/wikipedia/commons/a/a9/Flag_of_the_Soviet_Union.svg';
            legend.textContent = 'Balança de Poder da URSS';

            allEvents.forEach(event => {
                event.classList.add('hidden');
                event.classList.remove('previous-event');
                event.classList.remove('show-titles-only');
            });

            showEvents();
        });

        // Função para verificar se o evento 4 foi exibido e a página está no final
        function shouldDisableHover() {
            const event4Visible = !event4.classList.contains('hidden');
            const pageScrolledToBottom = window.innerHeight + window.scrollY >= document.body.offsetHeight;
            return event4Visible && pageScrolledToBottom;
        }

        // Função para atualizar o estado do hover com base na posição do scroll e visibilidade do evento 4
        function updateHoverState() {
            if (shouldDisableHover()) {
                // Desativa o hover para o evento 1
                event1.classList.add('disable-hover');
            } else {
                // Caso contrário, ativa o hover
                event1.classList.remove('disable-hover');
            }
        }

        // Adicionar ouvintes para o scroll e o resize para verificar a posição
        window.addEventListener('scroll', updateHoverState);
        window.addEventListener('resize', updateHoverState);

        // Atualizar o estado ao carregar a página
        updateHoverState();
        
    </script>
</body>
</html>
